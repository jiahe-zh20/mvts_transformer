Running:
D:\desktopfiles\python\mvts_transformer-master\src\main.py

Using device: cpu
Loading and preprocessing data ...
70 samples may be used for training
886 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=9, out_features=64, bias=True)
  (pos_enc): FixedPositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=16000, out_features=2, bias=True)
)
Total number of parameters: 182594
Trainable parameters: 182594
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 8.251647710800171 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 8.251647710800171 seconds
Avg batch val. time: 4.875117693628583 seconds
Avg sample val. time: 0.0770334624275397 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 0.696094 | accuracy: 0.364560 | precision: 0.421463 | AUROC: 0.643686 | AUPRC: 0.663905 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 0.662351 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 16.78086519241333 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 16.78086519241333 seconds
Avg batch train. time: 8.390432596206665 seconds
Avg sample train. time: 0.2397266456059047 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 11.229024887084961 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 9.740336298942566 seconds
Avg batch val. time: 4.981452592781612 seconds
Avg sample val. time: 0.07871369785433698 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 0.037409 | accuracy: 0.989842 | precision: 0.990113 | AUROC: 0.998721 | AUPRC: 0.999309 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 0.056811 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.67194652557373 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 16.22640585899353 seconds
Avg batch train. time: 8.113202929496765 seconds
Avg sample train. time: 0.23180579798562187 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 11.09187650680542 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 10.190849701563522 seconds
Avg batch val. time: 5.013632121540252 seconds
Avg sample val. time: 0.07922217799273536 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 0.047699 | accuracy: 0.990971 | precision: 0.991100 | AUROC: 0.998306 | AUPRC: 0.999102 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 0.008744 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.681546449661255 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 16.04478605588277 seconds
Avg batch train. time: 8.022393027941385 seconds
Avg sample train. time: 0.22921122936975385 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 0.013809 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.569825887680054 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.926046013832092 seconds
Avg batch train. time: 7.963023006916046 seconds
Avg sample train. time: 0.22751494305474418 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 11.15912413597107 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 10.432918310165405 seconds
Avg batch val. time: 5.030922736440386 seconds
Avg sample val. time: 0.07949539312659752 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 0.097164 | accuracy: 0.988713 | precision: 0.989047 | AUROC: 0.998732 | AUPRC: 0.999324 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 0.001828 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 16.030473470687866 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.946931505203247 seconds
Avg batch train. time: 7.973465752601624 seconds
Avg sample train. time: 0.22781330721718926 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.155518 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.965898513793945 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.950092673301697 seconds
Avg batch train. time: 7.975046336650848 seconds
Avg sample train. time: 0.2278584667614528 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 9.927678346633911 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 10.331870317459106 seconds
Avg batch val. time: 5.02370502267565 seconds
Avg sample val. time: 0.07938134347343015 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 0.149679 | accuracy: 0.984199 | precision: 0.984445 | AUROC: 0.997804 | AUPRC: 0.998811 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.005262 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.937108755111694 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.948237827845983 seconds
Avg batch train. time: 7.974118913922991 seconds
Avg sample train. time: 0.22783196896922833 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.041223 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.931435823440552 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.946137577295303 seconds
Avg batch train. time: 7.973068788647652 seconds
Avg sample train. time: 0.22780196538993291 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 12.203697681427002 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 10.643841544787094 seconds
Avg batch val. time: 5.045988681770507 seconds
Avg sample val. time: 0.079733455468157 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 0.309615 | accuracy: 0.959368 | precision: 0.959324 | AUROC: 0.993605 | AUPRC: 0.996231 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.007105 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.632723331451416 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.911313772201538 seconds
Avg batch train. time: 7.955656886100769 seconds
Avg sample train. time: 0.22730448246002197 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.000222 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.601718425750732 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.880354237556457 seconds
Avg batch train. time: 7.940177118778228 seconds
Avg sample train. time: 0.22686220339366367 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 8.412044286727905 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 10.32501336506435 seconds
Avg batch val. time: 5.023215240361739 seconds
Avg sample val. time: 0.07937360424950829 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 0.290516 | accuracy: 0.965011 | precision: 0.965716 | AUROC: 0.994462 | AUPRC: 0.996676 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.000066 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.700754642486572 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.864027001641013 seconds
Avg batch train. time: 7.932013500820506 seconds
Avg sample train. time: 0.2266289571663002 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.002892 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.935640335083008 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.869994779427847 seconds
Avg batch train. time: 7.934997389713923 seconds
Avg sample train. time: 0.2267142111346835 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 10.075566530227661 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 10.293832510709763 seconds
Avg batch val. time: 5.0209880364792685 seconds
Avg sample val. time: 0.0793384114116363 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 0.276142 | accuracy: 0.971783 | precision: 0.973257 | AUROC: 0.995878 | AUPRC: 0.997418 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.000446 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.586822986602783 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.848212333825918 seconds
Avg batch train. time: 7.924106166912959 seconds
Avg sample train. time: 0.22640303334037026 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.021394 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.484721899032593 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.82224873134068 seconds
Avg batch train. time: 7.91112436567034 seconds
Avg sample train. time: 0.22603212473343828 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 8.158033847808838 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 10.056521548165222 seconds
Avg batch val. time: 5.004037253440373 seconds
Avg sample val. time: 0.07907056608145059 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.319696 | accuracy: 0.969526 | precision: 0.971551 | AUROC: 0.996364 | AUPRC: 0.997340 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.011693 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.480727672576904 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.799480660756428 seconds
Avg batch train. time: 7.899740330378214 seconds
Avg sample train. time: 0.22570686658223468 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.000305 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.411694765090942 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.775244042277336 seconds
Avg batch train. time: 7.887622021138668 seconds
Avg sample train. time: 0.22536062917539051 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 8.85396122932434 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 9.936265516281125 seconds
Avg batch val. time: 4.995447536877223 seconds
Avg sample val. time: 0.0789348369258252 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.346474 | accuracy: 0.968397 | precision: 0.970580 | AUROC: 0.995531 | AUPRC: 0.995839 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.000143 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.537312269210815 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.761248055626364 seconds
Avg batch train. time: 7.880624027813182 seconds
Avg sample train. time: 0.22516068650894805 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.000028 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.54785680770874 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.749392986297607 seconds
Avg batch train. time: 7.874696493148804 seconds
Avg sample train. time: 0.22499132837568012 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 8.684936285018921 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 9.822508313439116 seconds
Avg batch val. time: 4.987322022388509 seconds
Avg sample val. time: 0.07880644279169201 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.328320 | accuracy: 0.969526 | precision: 0.971278 | AUROC: 0.995282 | AUPRC: 0.995552 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.000025 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.602097034454346 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.741640567779541 seconds
Avg batch train. time: 7.8708202838897705 seconds
Avg sample train. time: 0.22488057953970772 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.000020 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.494534969329834 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.729285287857056 seconds
Avg batch train. time: 7.864642643928528 seconds
Avg sample train. time: 0.2247040755408151 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 8.389302730560303 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 9.703074514865875 seconds
Avg batch val. time: 4.978791036776134 seconds
Avg sample val. time: 0.07867164166463417 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.310679 | accuracy: 0.976298 | precision: 0.976922 | AUROC: 0.995135 | AUPRC: 0.995527 | 
Best loss was 0.03740883801914499. Other metrics: OrderedDict([('epoch', 1), ('loss', 0.03740883801914499), ('accuracy', 0.989841986455982), ('precision', 0.9901132687168013), ('AUROC', 0.9987214791502754), ('AUPRC', 0.9993088307842248)])
All Done!
Total runtime: 0.0 hours, 19.0 minutes, 15.690673112869263 seconds

