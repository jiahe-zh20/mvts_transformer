Running:
D:\desktopfiles\python\mvts_transformer-master\src\main.py

Using device: cpu
Loading and preprocessing data ...
124 samples may be used for training
886 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=9, out_features=64, bias=True)
  (pos_enc): FixedPositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=16000, out_features=2, bias=True)
)
Total number of parameters: 182594
Trainable parameters: 182594
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 17.817055463790894 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 17.817055463790894 seconds
Avg batch val. time: 5.558361104556492 seconds
Avg sample val. time: 0.08782963370631026 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 0.428395 | accuracy: 0.983070 | precision: 0.983810 | AUROC: 0.999743 | AUPRC: 0.999854 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 0.258082 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 37.32120609283447 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 37.32120609283447 seconds
Avg batch train. time: 18.660603046417236 seconds
Avg sample train. time: 0.3009774684906006 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 12.764590978622437 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 15.290823221206665 seconds
Avg batch val. time: 5.377915944371905 seconds
Avg sample val. time: 0.08497835578014297 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 0.155008 | accuracy: 0.977427 | precision: 0.978724 | AUROC: 0.999820 | AUPRC: 0.999899 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 0.000026 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 34.252556562423706 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 35.78688132762909 seconds
Avg batch train. time: 17.893440663814545 seconds
Avg sample train. time: 0.28860388167442813 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 47.38212990760803 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 25.987925450007126 seconds
Avg batch val. time: 6.141994675000509 seconds
Avg sample val. time: 0.0970518345936875 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 0.286969 | accuracy: 0.971783 | precision: 0.973782 | AUROC: 0.999683 | AUPRC: 0.999826 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 0.000013 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 44.154757261276245 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 38.576173305511475 seconds
Avg batch train. time: 19.288086652755737 seconds
Avg sample train. time: 0.3110981718186409 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 0.082566 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 43.88743233680725 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 39.90398806333542 seconds
Avg batch train. time: 19.95199403166771 seconds
Avg sample train. time: 0.32180635534947916 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 47.27200102806091 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 31.30894434452057 seconds
Avg batch val. time: 6.522067453180041 seconds
Avg sample val. time: 0.10305749926018123 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 0.341171 | accuracy: 0.976298 | precision: 0.977724 | AUROC: 0.999503 | AUPRC: 0.999730 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 45.11391472816467 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 40.94597339630127 seconds
Avg batch train. time: 20.472986698150635 seconds
Avg sample train. time: 0.3302094628733973 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 46.24712824821472 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 41.829499204953514 seconds
Avg batch train. time: 20.914749602476757 seconds
Avg sample train. time: 0.3373346710076896 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 51.693779945373535 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 35.38591146469116 seconds
Avg batch val. time: 6.813279390335083 seconds
Avg sample val. time: 0.10765904228520447 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 0.215938 | accuracy: 0.986456 | precision: 0.986934 | AUROC: 0.999852 | AUPRC: 0.999917 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 46.76481747627258 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 42.53454467228481 seconds
Avg batch train. time: 21.267272336142405 seconds
Avg sample train. time: 0.34302052155068397 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.000010 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 47.145742893218994 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 43.11094444990158 seconds
Avg batch train. time: 21.55547222495079 seconds
Avg sample train. time: 0.347668906854045 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 48.890042781829834 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 37.63660001754761 seconds
Avg batch val. time: 6.974042858396258 seconds
Avg sample val. time: 0.11019932281890249 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 0.203506 | accuracy: 0.988713 | precision: 0.989047 | AUROC: 0.999951 | AUPRC: 0.999972 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.022387 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 47.53868007659912 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 43.602915075090195 seconds
Avg batch train. time: 21.801457537545097 seconds
Avg sample train. time: 0.3516364118958887 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 47.76078009605408 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 44.01870157718658 seconds
Avg batch train. time: 22.00935078859329 seconds
Avg sample train. time: 0.3549895288482789 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 56.27142381668091 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 40.29871770313808 seconds
Avg batch val. time: 7.16419412165272 seconds
Avg sample val. time: 0.11320397031956894 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 0.251299 | accuracy: 0.985327 | precision: 0.985887 | AUROC: 0.999929 | AUPRC: 0.999959 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 59.598071813583374 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 45.43500796231356 seconds
Avg batch train. time: 22.71750398115678 seconds
Avg sample train. time: 0.3664113545347868 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 1.0 minutes, 4.205193996429443 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 46.99919013182322 seconds
Avg batch train. time: 23.49959506591161 seconds
Avg sample train. time: 0.3790257268695421 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 58.076491594314575 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 42.52093943953514 seconds
Avg batch val. time: 7.322924245681081 seconds
Avg sample val. time: 0.11571212126358368 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 0.330755 | accuracy: 0.978555 | precision: 0.979730 | AUROC: 0.999809 | AUPRC: 0.999889 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 54.47366237640381 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 47.574149535252495 seconds
Avg batch train. time: 23.787074767626248 seconds
Avg sample train. time: 0.38366249625203624 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 57.21805739402771 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 48.263000096593586 seconds
Avg batch train. time: 24.131500048296793 seconds
Avg sample train. time: 0.3892177427144644 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 2.0 minutes, 4.688673734664917 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 44.98402102788289 seconds
Avg batch val. time: 7.498858644848778 seconds
Avg sample val. time: 0.11849212305630123 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.420837 | accuracy: 0.976298 | precision: 0.977494 | AUROC: 0.998123 | AUPRC: 0.998804 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 52.95100259780884 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 48.5755335966746 seconds
Avg batch train. time: 24.2877667983373 seconds
Avg sample train. time: 0.3917381741667307 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 53.78179097175598 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 48.90092468261719 seconds
Avg batch train. time: 24.450462341308594 seconds
Avg sample train. time: 0.39436229582755794 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 2.0 minutes, 11.863792896270752 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 47.67199821472168 seconds
Avg batch val. time: 7.690857015337263 seconds
Avg sample val. time: 0.12152595735295901 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.461155 | accuracy: 0.975169 | precision: 0.976490 | AUROC: 0.997500 | AUPRC: 0.998531 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 54.0978479385376 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 49.206626050612506 seconds
Avg batch train. time: 24.603313025306253 seconds
Avg sample train. time: 0.39682762944042344 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 55.318684816360474 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 49.54618487093184 seconds
Avg batch train. time: 24.77309243546592 seconds
Avg sample train. time: 0.39956600702364387 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 54.90872645378113 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 48.32988260009073 seconds
Avg batch val. time: 7.7378487571493375 seconds
Avg sample val. time: 0.12226849051928976 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.454658 | accuracy: 0.975169 | precision: 0.976490 | AUROC: 0.997208 | AUPRC: 0.998431 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 34.12504720687866 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 48.73454604650799 seconds
Avg batch train. time: 24.367273023253993 seconds
Avg sample train. time: 0.3930205326331289 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.000000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 30.069888830184937 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 47.80131318569183 seconds
Avg batch train. time: 23.900656592845916 seconds
Avg sample train. time: 0.38549446117493413 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 1.0 minutes, 8.00245714187622 seconds

Avg val. time: 0.0 hours, 1.0 minutes, 44.969263811906174 seconds
Avg batch val. time: 7.497804557993298 seconds
Avg sample val. time: 0.11847546705632751 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.436583 | accuracy: 0.975169 | precision: 0.976490 | AUROC: 0.996785 | AUPRC: 0.998298 | 
Best loss was 0.1550081488177071. Other metrics: OrderedDict([('epoch', 1), ('loss', 0.1550081488177071), ('accuracy', 0.9774266365688488), ('precision', 0.9787239563062712), ('AUROC', 0.999819695777603), ('AUPRC', 0.999899163075715)])
All Done!
Total runtime: 0.0 hours, 37.0 minutes, 0.8916850090026855 seconds

